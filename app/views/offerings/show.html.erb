
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Geocoding service</title>
    <style>
      html, body, #map-canvas {
        height: 100%;
        margin: 0px;
        padding: 0px
      }
      #panel {
        position: absolute;
        top: 5px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: #fff;
        padding: 5px;
        border: 1px solid #999;
      }
    </style>
        <script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false"></script>
    <script>
var geocoder;
var map;
function initialize() {
  geocoder = new google.maps.Geocoder();
  var latlng = new google.maps.LatLng(-34.397, 150.644);
  var mapOptions = {
    zoom: 8,
    // center: latlng
  }
  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
}

function codeAddress() {
  var address = document.getElementById('address').value;
  console.log(address)
  geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
      });
    } else {
      alert('Geocode was not successful for the following reason: ' + status);
    }
  });
}

google.maps.event.addDomListener(window, 'load', initialize);
  </script>


  </head>
<h1 class="learn_from"> Learn <%= @offering.subject.name %> from <%= @offering.teacher.first_name %> <img class="img-circle"<%= gravatar_for @offering.teacher %></h1>



<div class="meetup_place">
  <% if @offering.hangout %>
    <h4> <i class="icon-facetime-video"></i>  Available via Google hangouts</h4>
  <% end %>

  <% if @offering.location != '' %>
    <h4><i class="icon-map-marker"></i>  Available in person at: <%= @offering.location %></h4>
    
    
    <div id="map-canvas" style="height:300px"></div>
  <% end %>

  <div class="expertise_description">
    <h3> <%= @offering.teacher.first_name %>'s experience with <%= @offering.subject.name %>:</h3>
    <div class="expertise_details"><%= @offering.details %></div>
  </div>
<div>

<!-- <h3>Rankings would go here</h3>
<h3>Show up rate would go here</h3>
<h3>Reviews would go here</h3> -->

<br>
<!-- <button>Learn <%= @offering.subject.name %> from <%= @offering.teacher.first_name %></button> -->

<div><%#= link_to "Learn #{@offering.subject.name} from #{@offering.teacher.first_name}", meetups_path %></div>



<% if @offering.teacher_id == session[:user_id] %>

  <div class="edit_button btn btn-large btn-primary"><%= link_to "Edit Offering", edit_offering_path %></div><br>
  
<% else %>

  <%= "Learn #{@offering.subject.name} from #{@offering.teacher.first_name}" %>

	<% if @offering.hangout %>
    <%= button_to "Via Google Hangouts", controller: 'meetups', action: "create", :"data-offering_id" => @offering.id, :"data-method" => 'hangout' %>
  <% end %>

  <% if @offering.location != '' %>
    <%= button_to "In Person", controller: 'meetups', action: "create", :"data-offering_id" => @offering.id, :"data-method" => 'in-person' %>
  <% end %>

<% end %>

      <input id="address" type="hidden" value="<%= @offering.location %>">
      <input type="hidden" value="Geocode" onclick="codeAddress()">

<script type="text/javascript">
  
  google.maps.event.addDomListener(window, 'load', codeAddress);
</script>
<script type="text/javascript">
 
if (location.href.indexOf('reload')==-1)
{
   location.href=location.href+'?reload';
 
}
 
</script>





  
